# Программный комплекс нахождения линейной медианы для конечного числа бинарных отношений
Программа решает следующую задачу:

Дано n альтернатив  A={a<sub>1</sub>,a<sub>2</sub>,...,a<sub>n</sub>} и m экспертов. 
Эксперты выражают свои предпочтения как бинарные отношения &rho;<sub>t</sub> на множестве A.

Введем расстояние между &rho; и &rho;&prime;. Бинарные отношения можно представить в виде матриц
R(&rho;)=&Vert;r<sub>ij</sub>&Vert;<sub>(n&times;n)</sub> и R(&rho;&prime;)=&Vert;r&prime;<sub>ij</sub>&Vert;<sub>(n&times;n)</sub>, 
где r<sub>ij</sub>,r&prime;<sub>ij</sub> &isin;{0, 1}. 
Тогда расстояние можно задать метрикой Хемминга:

d(&rho;, &rho;&prime;) = &sum;<sup>n</sup><sub>i=1</sub> &sum;<sup>n</sup><sub>j=1</sub> |r<sub>ij</sub> - r&prime;<sub>ij</sub>|.

Требуется найти такой линейный порядок (или множество линейных порядков), 
сумма расстояний от которого до предпочтений экспертов минимальна. 
Такое бинарное отношение называется медианой Кемени:

&rho;&#770; &isin; Arg min<sub>&rho;&isin;LO[n]</sub>D(&rho;),

где D(&rho;) = &sum;<sup>m</sup><sub>t=1 </sub>d(&rho;, &rho;<sub>t</sub>), LO[n] – множество линейных порядков на множестве A.

# Table of Contents
- [Requriments](#Requriments)
- [Instalation](#Instalation)
- [Usage](#Usage)

# Requriments
Для работы решателя без интерфейса `matrix_solve.py`:
- graphviz
- numpy
- treelib

Для работы приложения с интерфейсом `application.py` потребуются библиотеки `matrix_solve.py`, а также:
- Pillow (PIL)
- prettytable

Для генерации тестов `rand_test.py` не потребуется никаких библиотек кроме встроенных.

Для анализа данных `analysis.py` потребуются библиотеки `matrix_solve.py`.

Для чтения анализа `read_analysis.py`:
- matplotlib

Для генерации особого случая `generate_special_case.py` не потребуется никаких библиотек кроме встроенных.

Для поиска особого случая `find_special_case.py`  потребуются библиотеки `matrix_solve.py`.
# Instalation
## Решатель без интерфейса:
Скачать
`matrix_solve.py`

## Оконное приложение:
Скачать
`application.py`,`matrix_solve.py`.

## Дополнительные программы
### Генератор тестов
Скачать 
`rand_test.py`.

`rand_test.py` - генерирует случайный тест и может записать его в текстовый файл.

### Анализ данных
Скачать
`read_analysis.py`,`analysis.py`,`rand_test.py`,`matrix_solve.py`.

`analysis.py` - запускает по K тестов подряд, собирает по ним статистику и сохраняет json (и красивую табличку в текстовый файл),

`read_analysis.py` - рисует разные графики по json файлу, сгенерированному `analysis.py`.

### Генератор частного случая
Скачать
`generate_special_case.py`.

`generate_special_case.py` - генерирует тест с разбиением на компоненты

### Поиск частного случая
Скачать
`find_special_case.py`,`matrix_solve.py`.

`find_special_case.py` - работает пока не создаст нужный тест (или превысит количество тестов)

# Usage
## Запуск решателя без интерфейса
Пример запуска решателя без интерфейса:
```commandline
python matrix_solve.py "tests/test_n3_m4.txt"
```
где `test/test_n3_m4.txt` - файл исходных данных в формате:
```
3 4                 # n и m через пробел или пустая строка (тогда n,m будут вычислены по следующему вводу)
1.0 0.5 1.5 1.0     # m весов (дробные числа, их сумма==m) через пробел или пустая строка если они равны
1 2 3               # мнение 1-го эксперта (перестановка индексов i=1,2,...,n записанная через пробел)
2 3 1               # мнение 2-го эксперта
1 3 2               # ...
3 2 1               # мнение m-го эксперта
                    # пустая строка
комментарии         # далее может следовать несколько строк комментариев
```
## Запуск оконного приложения
Для запуска оконного приложения запустите
```commandline
python application.py
```

1) При запуске приложения в первом окне необходимо выбрать формат ввода:

![окно выбора формата ввода](images/window1.PNG?raw=true)

2) В следующем окне нужно ввести количество альтернатив n и количество экспертов m. 

Количество альтернатив n и количество экспертов m - это натуральные числа. Также можно ввести данные из текстового файла, 
тогда программа перейдет к окну ввода данных.

![окно для ввода количества альтернатив и количества экспертов](images/window2.PNG?raw=true) 

4) Следующее окно предназначено для ввода данных.

Данные могут быть введены вручную или из текстового файла. После ввода данных из файла их можно изменить, но данные не изменятся в исходном файле.

Веса важности записываются как m чисел через пробел, дробная часть пишется через точку. Сумма весов должна равняться m.
Пустая строка будет воспринята как m весов равных 1.

Предпочтения в линейном формате вводятся как строчка индексов альтернатив через пробел (индексы от 1 до n включительно)

![окна для ввода весов важности экспертов и их предпочтений в линейном формате](images/window3_1.PNG?raw=true) 

Предпочтения в матричном формате вводятся как матрицы n на n, элементы которых 0 или 1.

![окна для ввода весов важности экспертов и их предпочтений в матричном формате](images/window3_2.PNG?raw=true) 

4) После ввода данных запускается окно с выбором способа решения.

![окно выбора способа решения](images/window4.PNG?raw=true)

5) После запуска решения будет запущено окно вывода решения. 

Ответ можно сохранить в текстовый файл, где сначала будет сохранены исходные данные, а затем как комментарий ответ.
Этот файл потом можно использовать как входные данные.
При сохранении решения в частном случае сохранится также и изображение графа.

Окно вывода решения обычным способом или с ускорением:

![окно с выводом обычного решения](images/window5_1.PNG?raw=true)

Если выполнены условия частного случая, то можно решить в частном случае. В окне вывода также будет показан граф мнений экспертов.

![окно с выводом решения в частном случае](images/window5_3.PNG?raw=true)

Окно вывода рейтинга альтернатив:

![окно с выводом рейтинга альтернатив](images/window5_4.PNG?raw=true)

Окно вывода результата сравнения двух альтернатив:

![окно с выводом сравнения альтернатив](images/window5_5.PNG?raw=true)
