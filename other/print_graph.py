import graphviz

"""C=[[0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], [1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1], [0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0], [1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0], [0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0], [0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1], [0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1], [1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1], [0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0], [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1], [0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0]]
D=[[0, 1, 3, 5, 6, 7, 10, 11, 15, 16, 18], [2], [4], [8], [9], [12], [13], [14], [17], [19]]
"""
C=[[0, 1, 0, 1, 1],
    [0, 0, 1, 1, 1],
    [1, 0, 0, 1, 1],
    [0, 0, 0, 0, 1],
    [0, 0, 0, 0, 0]]
D=[[0,1,2],[3],[4]]
n=len(C)
k=len(D)
CD = [[0] * k for _ in range(k)]
for i in range(k):
    for j in range(k):
        CD[i][j] = C[D[i][0]][D[j][0]]
g=graphviz.Digraph(name='main',engine='fdp')
g.attr(compound='true')

for i in range(n):
    g.node(f'a{i}', label=f'{i+1}')
for k1 in range(k):
    Ci = [[C[i][j] for j in D[k1] ]for i in D[k1]]
    ni=len(Ci)
    with g.subgraph(name=f'cluster{k1}') as c:
        for i in D[k1]:
            c.node(f'a{i}')
            for j in D[k1]:
                if C[i][j]:
                    c.edge(f'a{i}',f'a{j}')
        c.attr(label=f'D{k1+1}')
for k1 in range(k):
    for k2 in range(k):
        if C[D[k1][0]][D[k2][0]]:
            #g.edge(f'a{D[k1][0]}',f'a{D[k2][0]}',ltail=f'cluster{k1}', lhead=f'cluster{k2}',color='red')
            g.edge(f'cluster{k1}', f'cluster{k2}',color='blue')

print(g.source)
g.format='png'
g.render(directory='doctest-output', view=True)